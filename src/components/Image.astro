---
import type { LocalImageProps, RemoteImageProps } from "astro:assets";
import { Image as AstroImage, inferRemoteSize } from "astro:assets";

export type Props = LocalImageProps | RemoteImageProps;

const {
  widths = [],
  class: className,
  "class:list": classList,
  ...props
} = Astro.props;

const width =
  typeof props.width === "string"
    ? parseInt(props.width)
    : (props.width ?? (await inferRemoteSize(props.src as string)).width);
---

<AstroImage
  widths={[...widths, 300]}
  class:list={["image", className, classList]}
  {...props}
/>

<style>
  @import "@styles/variables.css";

  .image {
    width: 100%;
    height: auto;
    background-color: rgb(var(--color-background-box));

    border-style: solid;
    border-color: rgb(var(--color-border));
    border-width: var(--width-border);
    border-radius: var(--radius-layout);

    @media (--media-layout-mobile) {
      max-width: 300px;
    }
  }
</style>
